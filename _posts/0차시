---
layout: single
title: "[Database/DOIK] ë°”ë‹ë¼ ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹¤ìŠµ í™˜ê²½ ë°°í¬"
excerpt: "Database Operator In Kubernetes_Study_0ì°¨ì‹œ"
categories: Database
tag: [DOIK, Database Operator in Kubernetes, Database, ë°ì´í„°ë² ì´ìŠ¤, Kubernetes, ì¿ ë²„ë„¤í‹°ìŠ¤, DevOps, AWS, CloudFormation, vanilla, ë°”ë‹ë¼ ì¿ ë²„ë„¤í‹°ìŠ¤, kubeadm, docker, calico]
toc: true
author_profile: false
sidebar:
    nav: "docs"
---

# ì‚¬ì „ì¤€ë¹„
## ì „ì²´ êµ¬ì„±ë„

![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled.png)

- CloudFormation ìŠ¤íƒ ì‹¤í–‰ ì‹œ íŒŒë¼ë¯¸í„°ë¥¼ ê¸°ì…í•˜ë©´, í•´ë‹¹ ì •ë³´ê°€ ë°˜ì˜ë˜ì–´ ë°°í¬ë©ë‹ˆë‹¤.
- CloudFormation ì— EC2ì˜ **UserData** ë¶€ë¶„(**Script** ì‹¤í–‰)ìœ¼ë¡œ **ë°”ë‹ë¼** [vanilla](https://librewiki.net/wiki/%EB%B0%94%EB%8B%90%EB%9D%BC_(%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4)) **ì¿ ë²„ë„¤í‹°ìŠ¤** ì„¤ì¹˜ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤ (AWS EKS ë“± ê´€ë¦¬í˜• ë¯¸ì‚¬ìš©)
    - **ì¿ ë²„ë„¤í‹°ìŠ¤** ë²„ì „ v1.23.6 , Calico **CNI**(CrossSubnet ëª¨ë“œ, ENI S/D Uncheck) , **CRI**(Docker), **StorageClass**(local-path, hostpath)
- ì‚¬ìš©ì ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ì€ í¼ë¸”ë¦­ ì„œë¸Œë„· 2ê°œì™€ í”„ë¼ì´ë¹— ì„œë¸Œë„· 2ê°œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤
- **ë§ˆìŠ¤í„°** ë…¸ë“œ **1**ëŒ€, **ì›Œì»¤** ë…¸ë“œëŠ” ê¸°ë³¸ì€ **3**ëŒ€ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤
    - `EC2 Spec` : Ubuntu 22.04 , t3.medium (2CPU 4MEM, 0.052 USD x 4ëŒ€ = 0.208USD = 1ì‹œê°„ ë‹¹ **266**ì›) - [ê°€ê²©](https://aws.amazon.com/ko/ec2/pricing/on-demand/), EBS gp3 40GiB
    
    | Hostname | IPv4 |
    | --- | --- |
    | k8s-m | 192.168.10.10 |
    | k8s-w1 | 192.168.10.101 |
    | k8s-w2 | 192.168.10.102 |
    | k8s-w3 | 192.168.20.103 |

## Cloudfarmationìœ¼ë¡œ ìë™ ë°°í¬

### 0ë‹¨ê³„ : EC2 ì ‘ì†ì— ì‚¬ìš©í•˜ëŠ” SSH Key ìƒì„±

[1ë‹¨ê³„: EC2 SSH í‚¤ í˜ì–´ ìƒì„±](https://docs.aws.amazon.com/ko_kr/ground-station/latest/ug/create-ec2-ssh-key-pair.html)

1. AWS Management Consoleì—ì„œ AWS ë¦¬ì „ ì„ íƒ : `ap-northeast-2 (ì„œìš¸)`
2. ì„œë¹„ìŠ¤ > EC2 > ë„¤íŠ¸ì›Œí¬ ë° ë³´ì•ˆ > í‚¤ í˜ì–´ > í‚¤ í˜ì–´ ìƒì„±
3. ì´ë¦„ : `doik-ec2-access-key-ap-northeast-2` / í‚¤ í˜ì–´ ìœ í˜• : `RSA` *(ê³µê°œí‚¤)* / í”„ë¼ì´ë¹— í‚¤ íŒŒì¼ í˜•ì‹ : `.ppk` *(PuTTYì™€ í•¨ê»˜ ì‚¬ìš©)* > í‚¤ í˜ì–´ ìƒì„±

### 1ë‹¨ê³„ : í…œí”Œë¦¿ ì§€ì •

- ì¤€ë¹„ëœ í…œí”Œë¦¿
- Amazon S3 URL

![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%201.png)

### 2ë‹¨ê³„ : ìŠ¤íƒ ì„¸ë¶€ ì •ë³´ ì§€ì •

1. ìŠ¤íƒ ì´ë¦„ : `myk8s` *(ê¸°ë³¸)*
2. íŒŒë¼ë¯¸í„° : ì•„ë˜ **ë¹¨ê°„ìƒ‰** ë¶€ë¶„ì€ **ì„¤ì •** í•„ìš”, **ê·¸ ì™¸** ë¶€ë¶„ì€ **ê¸°ë³¸ ê°’** ì‚¬ìš© ê¶Œì¥.
    - **<<<<< EC2 Node >>>>>**
        - **KeyName** : 0ë‹¨ê³„ì—ì„œ ìƒì„±í•œ KeetPair ì„ íƒ
        - **SgIngressCidr** : EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì ‘ì†í•  ìˆ˜ ìˆëŠ” IP ì£¼ì†Œ ì…ë ¥ (`ì§‘ ê³µì¸IP/32`) â† **ë³´ì•ˆê·¸ë£¹** : **ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš©**ì´ë‹ˆ ì£¼ì˜!
        - MasterNodeInstanceType & WorkerNodeInstanceType: ë§ˆìŠ¤í„° & ì›Œì»¤ ë…¸ë“œ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì… (ê¸°ë³¸ **t3.medium**) â‡’ ë³€ê²½ ê°€ëŠ¥
        - Ec2EbsVolumeSize : EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ **EBS** ë³¼ë¥¨ í¬ê¸° (GiB) â‡’ ë³€ê²½ ê°€ëŠ¥
        - LatestAmiId : Ubuntu 22.04 LTS ìµœì‹  ë²„ì „ AMI ID ê°€ ìë™ ì§€ì •ë¨
    - **<<<<< Region AZ >>>>>** : ë¦¬ì „ê³¼ ê°€ìš©ì˜ì—­ì„ ì§€ì •
    - **<<<<< VPC Subnet >>>>>** : VPC, ì„œë¸Œë„· ì •ë³´ ì§€ì •

### 3ë‹¨ê³„ : ìŠ¤íƒ ì˜µì…˜ êµ¬ì„±

- íŒ¨ìŠ¤

### 4ë‹¨ê³„ : ê²€í† 

- ë‚´ìš© í™•ì¸ > ìŠ¤íƒ ìƒì„±
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%202.png)
    
- ì¸ìŠ¤í„´ìŠ¤ ìƒì„± í™•ì¸
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%203.png)
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%204.png)
    

### Trouble Shooting - EC2 ì ‘ì†

- EC2 ì¸ìŠ¤í„´ìŠ¤ ì—°ê²°ë¡œ ì—°ê²°í•  ë•Œ ì—ëŸ¬ ë°œìƒ
    
    ```jsx
    There was a problem connecting to your instance
    We were unable to connect to your instance. Make sure that your instanceâ€™s network settings are configured correctly for EC2 Instance Connect. For more information, see Task 1: Configure network access to an instance.
    ```
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%205.png)
    

```jsx
**gain@LAPTOP-NGE5O25S:/mnt/c/Users/User/Downloads$ sudo apt-get install ec2-instance-connect**
	[sudo] password for gain:
	Sorry, try again.
	[sudo] password for gain:
	Reading package lists... Done
	Building dependency tree
	Reading state information... Done
	The following NEW packages will be installed:
	  ec2-instance-connect
	0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
	Need to get 12.8 kB of archives.
	After this operation, 57.3 kB of additional disk space will be used.
	Get:1 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 ec2-instance-connect all 1.1.12+dfsg1-0ubuntu3.20.04.1 [12.8 kB]
	Fetched 12.8 kB in 1s (8959 B/s)
	Selecting previously unselected package ec2-instance-connect.
	(Reading database ... 32548 files and directories currently installed.)
	Preparing to unpack .../ec2-instance-connect_1.1.12+dfsg1-0ubuntu3.20.04.1_all.deb ...
	Created system user ec2-instance-connect
	Unpacking ec2-instance-connect (1.1.12+dfsg1-0ubuntu3.20.04.1) ...
	Setting up ec2-instance-connect (1.1.12+dfsg1-0ubuntu3.20.04.1) ...
	Created symlink /etc/systemd/system/multi-user.target.wants/ec2-instance-connect.service â†’ /lib/systemd/system/ec2-instance-connect.service.
	System has not been booted with systemd as init system (PID 1). Can't operate.
	Failed to connect to bus: Host is down
	sshd override added, restarting daemon
	System has not been booted with systemd as init system (PID 1). Can't operate.
	Failed to connect to bus: Host is down
	System has not been booted with systemd as init system (PID 1). Can't operate.
	Failed to connect to bus: Host is down
	dpkg: error processing package ec2-instance-connect (--configure):
	 installed ec2-instance-connect package post-installation script subprocess returned error exit status 1
	Errors were encountered while processing:
	 ec2-instance-connect
	E: Sub-process /usr/bin/dpkg returned an error code (1)
```

![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%206.png)

## í´ëŸ¬ìŠ¤í„° ìƒì„±

- `init.sh` : EC2 ê³µí†µ ì ìš©, ë„ì»¤ ë“± ê¸°ë³¸ ì„¤ì •, ê³„ì •(root / Pa55W0rd), [bat](https://github.com/sharkdp/bat) íˆ´ ë“± ì„¤ì¹˜
- `master.sh` : ì¿ ë²„ë„¤í‹°ìŠ¤ ì´ˆê¸°í™” êµ¬ì„± ë° í¸ë¦¬ ì„¤ì •, íŒŒë“œ ëŒ€ì—­(172.16.0.0), ì„œë¹„ìŠ¤ ëŒ€ì—­(10.200.1.0/24)
- `worker.sh` : ë§ˆìŠ¤í„° ë…¸ë“œ Join, kubeconfig íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
- `final.sh` : CNI/CSI ì„¤ì¹˜ ë“±

### setup

1. Master Node ì ‘ì†
    - pem í‚¤ë¡œ ssh ì ‘ì†í•˜ë©´ ë”°ë¡œ password í•„ìš”ì—†ëŠ” ì¤„ ì•Œì•˜ëŠ”ë° password ìš”êµ¬í•˜ë”ë¼.. ê·¸ë˜ì„œ ì…ë ¥í•´ ì¤˜ì„œ ê²¨ìš° ì ‘ì† ì™„!
        
        ```jsx
        **gain@LAPTOP-NGE5O25S:/mnt/c/Users/User/Downloads$ ssh -i ./myk8s-ec2-access-key-ap-northeast-2.pem root@52.78.18.102**
        	@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        	@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
        	@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        	Permissions 0777 for './myk8s-ec2-access-key-ap-northeast-2.pem' are too open.
        	It is required that your private key files are NOT accessible by others.
        	This private key will be ignored.
        	Load key "./myk8s-ec2-access-key-ap-northeast-2.pem": bad permissions
        	**root@52.78.18.102's password:**
        	
        	Welcome to Ubuntu 22.04 LTS (GNU/Linux 5.15.0-1005-aws x86_64)
        	
        	 * Documentation:  https://help.ubuntu.com
        	 * Management:     https://landscape.canonical.com
        	 * Support:        https://ubuntu.com/advantage
        	
        	  System information as of Sun May 22 21:24:26 KST 2022
        	
        	  System load:  1.9853515625      Processes:                161
        	  Usage of /:   9.0% of 38.60GB   Users logged in:          0
        	  Memory usage: 21%               IPv4 address for docker0: 172.17.0.1
        	  Swap usage:   0%                IPv4 address for ens5:    192.168.10.10
        	
        	
        	16 updates can be applied immediately.
        	12 of these updates are standard security updates.
        	To see these additional updates run: apt list --upgradable
        ```
        
2. ì„¤ì¹˜ ë¡œê·¸ í™•ì¸
    
    ```jsx
    **(ğŸ |kubernetes-admin@kubernetes:default) root@k8s-m:~# sudo tail -f /var/log/cloud-init-output.log**
    	No services need to be restarted.
    	
    	No containers need to be restarted.
    	
    	No user sessions are running outdated binaries.
    	
    	No VM guests are running outdated hypervisor (qemu) binaries on this host.
    	/nfs4-share     <world>(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)
    	>>>> K8S Controlplane Config End <<<<
    	Cloud-init v. 22.1-14-g2e17a0d6-0ubuntu1~22.04.5 finished at Sun, 22 May 2022 12:24:19 +0000. Datasource DataSourceEc2Local.  Up 181.88 seconds
    ```
    
3. CNI/StorageClass ë“± ****ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
    - Master Node SSH ì¢…ë£Œ í›„ ë‹¤ì‹œ SSH ì ‘ì†
    
    ```jsx
    **(ğŸ |kubernetes-admin@kubernetes:default) root@k8s-m:~# exa -bghHliSR DOIK/**
    	 inode Permissions Links Size Blocks User Group Date Modified Name
    	516217 drwxr-xr-x      2    -      - root root  22 May 21:23  1
    	516239 .rw-r--r--      1   55      8 root root  22 May 21:23  README.md
    	
    	DOIK/1:
    	 inode Permissions Links  Size Blocks User Group Date Modified Name
    	516232 .rw-r--r--      1   782      8 root root  22 May 21:23  1-3pods.yaml
    	516233 .rw-r--r--      1 213Ki    432 root root  22 May 21:23  calico-crosssubnet-v3.22.2.yaml
    	516234 .rwx------      1 1.2Ki      8 root root  22 May 21:23  final.sh
    	516235 .rwx------      1 2.3Ki      8 root root  22 May 21:23  init.sh
    	516236 .rwx------      1 1.9Ki      8 root root  22 May 21:23  master.sh
    	516237 .rw-r--r--      1 4.1Ki     16 root root  22 May 21:23  metrics-server.yaml
    	516238 .rwx------      1   971      8 root root  22 May 21:23  worker.sh
    **(ğŸ |kubernetes-admin@kubernetes:default) root@k8s-m:~# cd /root/DOIK/1 && ./final.sh && cd $HOME**
    	+ echo '[TASK 10] Install Calico CNI'
    	[TASK 10] Install Calico CNI
    	+ kubectl apply -f https://raw.githubusercontent.com/gasida/DOIK/main/1/calico-crosssubnet-v3.22.2.yaml
    	...ì¤‘ëµ...
    	NAME: nfs-provisioner
    	LAST DEPLOYED: Mon May 23 01:09:44 2022
    	NAMESPACE: kube-system
    	STATUS: deployed
    	REVISION: 1
    	TEST SUITE: None
    ```
    

### í™•ì¸

1. cluster ë° node ì •ë³´ í™•ì¸
    
    ```jsx
    **(ğŸ |kubernetes-admin@kubernetes:default) root@k8s-m:~# kubectl cluster-info** 
    	Kubernetes control plane is running at https://192.168.10.10:6443
    	CoreDNS is running at https://192.168.10.10:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
    	
    	To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.
    **(ğŸ |kubernetes-admin@kubernetes:default) root@k8s-m:~# kubectl get nodes -o wide**
    	NAME     STATUS     ROLES                  AGE     VERSION   INTERNAL-IP      EXTERNAL-IP   OS-IMAGE           KERNEL-VERSION    CONTAINER-RUNTIME
    	k8s-m    NotReady   control-plane,master   3h40m   v1.23.6   192.168.10.10    <none>        Ubuntu 22.04 LTS   5.15.0-1005-aws   docker://20.10.16
    	k8s-w1   NotReady   <none>                 3h39m   v1.23.6   192.168.10.101   <none>        Ubuntu 22.04 LTS   5.15.0-1005-aws   docker://20.10.16
    	k8s-w2   NotReady   <none>                 3h39m   v1.23.6   192.168.10.102   <none>        Ubuntu 22.04 LTS   5.15.0-1005-aws   docker://20.10.16
    	k8s-w3   NotReady   <none>                 3h39m   v1.23.6   192.168.20.103   <none>        Ubuntu 22.04 LTS   5.15.0-1005-aws   docker://20.10.16
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# systemctl status kubelet**
    	â— kubelet.service - kubelet: The Kubernetes Node Agent
    	     Loaded: loaded (/lib/systemd/system/kubelet.service; enabled; vendor preset: enabled)
    	    Drop-In: /etc/systemd/system/kubelet.service.d
    	             â””â”€10-kubeadm.conf
    	     Active: active (running) since Sun 2022-05-22 21:24:01 KST; 3h 50min ago
    	       Docs: https://kubernetes.io/docs/home/
    	   Main PID: 6426 (kubelet)
    	      Tasks: 16 (limit: 4623)
    	     Memory: 39.5M
    	        CPU: 4min 17.733s
    	     CGroup: /system.slice/kubelet.service
    	             â””â”€6426 /usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.co>
    	May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.691582    6426 plugins.go:752] "Error dynamically probing plugins" err="error creating>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.691782    6426 driver-call.go:262] Failed to unmarshal output for command: init, outpu>May 23 01:09:55 k8s-m kubelet[6426]: W0523 01:09:55.691796    6426 driver-call.go:149] FlexVolume: driver call failed: executable: /usr/li>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.691812    6426 plugins.go:752] "Error dynamically probing plugins" err="error creating>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.692032    6426 driver-call.go:262] Failed to unmarshal output for command: init, outpu>May 23 01:09:55 k8s-m kubelet[6426]: W0523 01:09:55.692048    6426 driver-call.go:149] FlexVolume: driver call failed: executable: /usr/li>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.692065    6426 plugins.go:752] "Error dynamically probing plugins" err="error creating>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.692552    6426 driver-call.go:262] Failed to unmarshal output for command: init, outpu>May 23 01:09:55 k8s-m kubelet[6426]: W0523 01:09:55.692563    6426 driver-call.go:149] FlexVolume: driver call failed: executable: /usr/li>May 23 01:09:55 k8s-m kubelet[6426]: E0523 01:09:55.692581    6426 plugins.go:752] "Error dynamically probing plugins" err="error creating>lines 1-23/23 (END)
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl get node -v7**
    	I0523 01:15:39.343489   54205 loader.go:372] Config loaded from file:  /root/.kube/config
    	I0523 01:15:39.350372   54205 round_trippers.go:463] GET https://192.168.10.10:6443/api/v1/nodes?limit=500
    	I0523 01:15:39.350496   54205 round_trippers.go:469] Request Headers:
    	I0523 01:15:39.350513   54205 round_trippers.go:473]     Accept: application/json;as=Table;v=v1;g=meta.k8s.io,application/json;as=Table;v=v1beta1;g=meta.k8s.io,application/json
    	I0523 01:15:39.350612   54205 round_trippers.go:473]     User-Agent: kubectl/v1.23.6 (linux/amd64) kubernetes/ad33385
    	I0523 01:15:39.358562   54205 round_trippers.go:574] Response Status: 200 OK in 7 milliseconds
    	NAME     STATUS   ROLES                  AGE     VERSION
    	k8s-m    Ready    control-plane,master   3h51m   v1.23.6
    	k8s-w1   Ready    <none>                 3h51m   v1.23.6
    	k8s-w2   Ready    <none>                 3h51m   v1.23.6
    	k8s-w3   Ready    <none>                 3h51m   v1.23.6
    ```
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%207.png)
    
2. kube-system í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl get pod -A**
    	NAMESPACE            NAME                                                              READY   STATUS    RESTARTS   AGE
    	kube-system          calico-kube-controllers-7c845d499-v5qfh                           1/1     Running   0          6m52s
    	kube-system          calico-node-cpwhx                                                 1/1     Running   0          6m52s
    	kube-system          calico-node-njvrx                                                 1/1     Running   0          6m52s
    	kube-system          calico-node-sn7tg                                                 1/1     Running   0          6m52s
    	kube-system          calico-node-x4r8b                                                 1/1     Running   0          6m52s
    	kube-system          coredns-64897985d-856gx                                           1/1     Running   0          3h52m
    	kube-system          coredns-64897985d-m7l58                                           1/1     Running   0          3h52m
    	kube-system          etcd-k8s-m                                                        1/1     Running   0          3h52m
    	kube-system          kube-apiserver-k8s-m                                              1/1     Running   0          3h52m
    	kube-system          kube-controller-manager-k8s-m                                     1/1     Running   0          3h52m
    	kube-system          kube-proxy-dvcnf                                                  1/1     Running   0          3h52m
    	kube-system          kube-proxy-gxb6c                                                  1/1     Running   0          3h52m
    	kube-system          kube-proxy-ts8ht                                                  1/1     Running   0          3h52m
    	kube-system          kube-proxy-x6kkd                                                  1/1     Running   0          3h52m
    	kube-system          kube-scheduler-k8s-m                                              1/1     Running   0          3h52m
    	kube-system          metrics-server-6c8bfb487b-r8zs2                                   1/1     Running   0          6m44s
    	kube-system          nfs-provisioner-nfs-subdir-external-provisioner-7d9776885d5b7h5   1/1     Running   0          6m38s
    	local-path-storage   local-path-provisioner-dbd774c5c-tjfnh                            1/1     Running   0          6m44s
    ```
    
3. Calico CNI í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# calicoctl get ippool -o wide**
    	NAME                  CIDR            NAT    IPIPMODE      VXLANMODE   DISABLED   DISABLEBGPEXPORT   SELECTOR   
    	default-ipv4-ippool   172.16.0.0/16   true   CrossSubnet   Never       false      false              all()
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# calicoctl node status**
    	Calico process is running.
    	
    	IPv4 BGP status
    	+----------------+-------------------+-------+----------+-------------+
    	|  PEER ADDRESS  |     PEER TYPE     | STATE |  SINCE   |    INFO     |
    	+----------------+-------------------+-------+----------+-------------+
    	| 192.168.10.101 | node-to-node mesh | up    | 16:10:18 | Established |
    	| 192.168.10.102 | node-to-node mesh | up    | 16:10:20 | Established |
    	| 192.168.20.103 | node-to-node mesh | up    | 16:10:18 | Established |
    	+----------------+-------------------+-------+----------+-------------+
    	
    	IPv6 BGP status
    	No IPv6 peers found.
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# calicoctl ipam show --show-blocks**
    	+----------+-----------------+-----------+------------+--------------+
    	| GROUPING |      CIDR       | IPS TOTAL | IPS IN USE |   IPS FREE   |
    	+----------+-----------------+-----------+------------+--------------+
    	| IP Pool  | 172.16.0.0/16   |     65536 | 9 (0%)     | 65527 (100%) |
    	| Block    | 172.16.116.0/24 |       256 | 1 (0%)     | 255 (100%)   |
    	| Block    | 172.16.158.0/24 |       256 | 1 (0%)     | 255 (100%)   |
    	| Block    | 172.16.184.0/24 |       256 | 6 (2%)     | 250 (98%)    |
    	| Block    | 172.16.24.0/24  |       256 | 1 (0%)     | 255 (100%)   |
    	+----------+-----------------+-----------+------------+--------------+
    ```
    
4. storageclasses í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl get storageclasses**
    	NAME                   PROVISIONER                                                     RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
    	local-path (default)   rancher.io/local-path                                           Delete          WaitForFirstConsumer   false                  11m
    	nfs-client             cluster.local/nfs-provisioner-nfs-subdir-external-provisioner   Delete          Immediate              true                   11m
    ```
    
5. ë³¼ë¥¨ í™•ì¸
    
    ```jsx
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# lsblk                                                                                                 PANSION   AGE
    	NAME         MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS                                                                                                    11m
    	loop0          7:0    0 26.6M  1 loop /snap/amazon-ssm-agent/5163                                                                                    11m
    	loop1          7:1    0 55.5M  1 loop /snap/core18/2344
    	loop2          7:2    0 61.9M  1 loop /snap/core20/1434
    	loop3          7:3    0 79.9M  1 loop /snap/lxd/22923
    	loop4          7:4    0 44.7M  1 loop /snap/snapd/15534
    	nvme0n1      259:0    0   40G  0 disk
    	â”œâ”€nvme0n1p1  259:1    0 39.9G  0 part /
    	â”œâ”€nvme0n1p14 259:2    0    4M  0 part
    	â””â”€nvme0n1p15 259:3    0  106M  0 part /boot/efi
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# df -h -T -t ext4
    	Filesystem     Type  Size  Used Avail Use% Mounted on
    	/dev/root      ext4   39G  4.4G   35G  12% /
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# duf
    	â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
    	â”‚ 2 local devices                                                                             â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ MOUNTED ON â”‚   SIZE â”‚ USED â”‚ AVAIL â”‚              USE%             â”‚ TYPE â”‚ FILESYSTEM      â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ /          â”‚  38.6G â”‚ 4.3G â”‚ 34.2G â”‚ [##..................]  11.2% â”‚ ext4 â”‚ /dev/root       â”‚
    	â”‚ /boot/efi  â”‚ 104.4M â”‚ 5.2M â”‚ 99.1M â”‚ [....................]   5.0% â”‚ vfat â”‚ /dev/nvme0n1p15 â”‚
    	â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
    	â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
    	â”‚ 8 special devices                                                                                             â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ MOUNTED ON                  â”‚   SIZE â”‚  USED â”‚  AVAIL â”‚              USE%             â”‚ TYPE     â”‚ FILESYSTEM â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ /dev                        â”‚   1.9G â”‚    0B â”‚   1.9G â”‚                               â”‚ devtmpfs â”‚ devtmpfs   â”‚
    	â”‚ /dev/shm                    â”‚   1.9G â”‚    0B â”‚   1.9G â”‚                               â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ /run                        â”‚ 773.1M â”‚  1.9M â”‚ 771.2M â”‚ [....................]   0.2% â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ /run/lock                   â”‚   5.0M â”‚    0B â”‚   5.0M â”‚                               â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ /run/snapd/ns               â”‚ 773.1M â”‚  1.9M â”‚ 771.2M â”‚ [....................]   0.2% â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ /run/user/0                 â”‚ 386.6M â”‚  4.0K â”‚ 386.6M â”‚ [....................]   0.0% â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ /var/lib/kubelet/pods/423fc â”‚   3.7G â”‚ 12.0K â”‚   3.7G â”‚ [....................]   0.0% â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ 781-c2f8-4e05-ba30-078de928 â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ 9454/volumes/kubernetes.io~ â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ projected/kube-api-access-s â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ z5c2                        â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ /var/lib/kubelet/pods/cf06f â”‚   3.7G â”‚ 12.0K â”‚   3.7G â”‚ [....................]   0.0% â”‚ tmpfs    â”‚ tmpfs      â”‚
    	â”‚ 924-bc28-4746-84e8-adb8e488 â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ 880d/volumes/kubernetes.io~ â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ projected/kube-api-access-k â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â”‚ rm98                        â”‚        â”‚       â”‚        â”‚                               â”‚          â”‚            â”‚
    	â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# duf -all
    	â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
    	â”‚ 22 local devices                                                                                                    â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ MOUNTED ON                  â”‚   SIZE â”‚  USED â”‚ AVAIL â”‚              USE%             â”‚ TYPE       â”‚ FILESYSTEM      â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ /                           â”‚  38.6G â”‚  4.3G â”‚ 34.2G â”‚ [##..................]  11.2% â”‚ ext4       â”‚ /dev/root       â”‚
    	â”‚ /boot/efi                   â”‚ 104.4M â”‚  5.2M â”‚ 99.1M â”‚ [....................]   5.0% â”‚ vfat       â”‚ /dev/nvme0n1p15 â”‚
    	â”‚ /proc/fs/nfsd               â”‚     0B â”‚    0B â”‚    0B â”‚                               â”‚ nfsd       â”‚ nfsd            â”‚
    	â”‚ /run/credentials/systemd-sy â”‚     0B â”‚    0B â”‚    0B â”‚                               â”‚ ramfs      â”‚ none            â”‚
    	â”‚ susers.service              â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â”‚ /run/rpc_pipefs             â”‚     0B â”‚    0B â”‚    0B â”‚                               â”‚ rpc_pipefs â”‚ sunrpc          â”‚
    	â”‚ /snap/amazon-ssm-agent/5163 â”‚  26.8M â”‚ 26.8M â”‚    0B â”‚ [####################] 100.0% â”‚ squashfs   â”‚ /dev/loop0      â”‚
    	â”‚ /snap/core18/2344           â”‚  55.6M â”‚ 55.6M â”‚    0B â”‚ [####################] 100.0% â”‚ squashfs   â”‚ /dev/loop1      â”‚
    	â”‚ /snap/core20/1434           â”‚  62.0M â”‚ 62.0M â”‚    0B â”‚ [####################] 100.0% â”‚ squashfs   â”‚ /dev/loop2      â”‚
    	â”‚ /snap/lxd/22923             â”‚  80.0M â”‚ 80.0M â”‚    0B â”‚ [####################] 100.0% â”‚ squashfs   â”‚ /dev/loop3      â”‚
    	â”‚ /snap/snapd/15534           â”‚  44.8M â”‚ 44.8M â”‚    0B â”‚ [####################] 100.0% â”‚ squashfs   â”‚ /dev/loop4      â”‚
    	â”‚ /var/lib/docker/overlay2/09 â”‚  38.6G â”‚  4.3G â”‚ 34.2G â”‚ [##..................]  11.2% â”‚ overlay    â”‚ overlay         â”‚
    	â”‚ 040056f296a22c63e56c38ce277 â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â”‚ f68574fe9e90679bce7bf73ea9a â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â”‚ ae66f5a0/merged             â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	//...ì¤‘ëµ...
    	â”‚ /var/lib/docker/overlay2/c4 â”‚  38.6G â”‚  4.3G â”‚ 34.2G â”‚ [##..................]  11.2% â”‚ overlay    â”‚ overlay         â”‚
    	â”‚ bbcbdf897eb422bb39142ef281a â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â”‚ 427e298571d4cc3021d406b78ec â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â”‚ aef96587/merged             â”‚        â”‚       â”‚       â”‚                               â”‚            â”‚                 â”‚
    	â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
    	â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
    	â”‚ 31 special devices                                                                                                â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ MOUNTED ON                  â”‚   SIZE â”‚  USED â”‚  AVAIL â”‚              USE%             â”‚ TYPE        â”‚ FILESYSTEM  â”‚
    	â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    	â”‚ /dev                        â”‚   1.9G â”‚    0B â”‚   1.9G â”‚                               â”‚ devtmpfs    â”‚ devtmpfs    â”‚
    	//...ì¤‘ëµ...
    	â”‚ /var/lib/kubelet/pods/cf06f â”‚   3.7G â”‚ 12.0K â”‚   3.7G â”‚ [....................]   0.0% â”‚ tmpfs       â”‚ tmpfs       â”‚
    	â”‚ 924-bc28-4746-84e8-adb8e488 â”‚        â”‚       â”‚        â”‚                               â”‚             â”‚             â”‚
    	â”‚ 880d/volumes/kubernetes.io~ â”‚        â”‚       â”‚        â”‚                               â”‚             â”‚             â”‚
    	â”‚ projected/kube-api-access-k â”‚        â”‚       â”‚        â”‚                               â”‚             â”‚             â”‚
    	â”‚ rm98                        â”‚        â”‚       â”‚        â”‚                               â”‚             â”‚             â”‚
    	â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
    	
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# exportfs -v**
    	/nfs4-share     <world>(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)
    ```
    
6. EC2 ê¸°ë³¸ ì •ë³´ í™•ì¸ *(ì˜µì…˜)*
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# hostnamectl** 
    	 Static hostname: k8s-m
    	       Icon name: computer-vm
    	         Chassis: vm
    	      Machine ID: ec2183cac29bcaba0c31a1f551bff9a3
    	         Boot ID: 3e124726ada340d695ba717566b490e2
    	  Virtualization: amazon
    	Operating System: Ubuntu 22.04 LTS
    	          Kernel: Linux 5.15.0-1005-aws
    	    Architecture: x86-64
    	 Hardware Vendor: Amazon EC2
    	  Hardware Model: t3.medium
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# cat /etc/hostname** 
    	â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ File: /etc/hostname
    	â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   1   â”‚ k8s-m
    	â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€(ğŸ |DOIK-Lab:default) root@k8s-m:~# cat /etc/hosts
    	â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ File: /etc/hosts
    	â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   1   â”‚ 127.0.0.1 localhost
    	   2   â”‚
    	   3   â”‚ # The following lines are desirable for IPv6 capable hosts
    	   4   â”‚ ::1 ip6-localhost ip6-loopback
    	   5   â”‚ fe00::0 ip6-localnet
    	   6   â”‚ ff00::0 ip6-mcastprefix
    	   7   â”‚ ff02::1 ip6-allnodes
    	   8   â”‚ ff02::2 ip6-allrouters
    	   9   â”‚ ff02::3 ip6-allhosts
    	  10   â”‚ 192.168.10.10 k8s-m
    	  11   â”‚ 192.168.10.101 k8s-w1
    	  12   â”‚ 192.168.10.102 k8s-w2
    	  13   â”‚ 192.168.20.103 k8s-w3
    	  14   â”‚ 192.168.20.104 k8s-w4
    	â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€(ğŸ |DOIK-Lab:default) root@k8s-m:~# ip -br -c -4 addr
    	lo               UNKNOWN        127.0.0.1/8 
    	ens5             UP             192.168.10.10/24 metric 100
    	docker0          DOWN           172.17.0.1/16
    	tunl0@NONE       UNKNOWN        172.16.116.0/32
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# cat /etc/resolv.conf** 
    	â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ File: /etc/resolv.conf
    	â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   1   â”‚ # This is /run/systemd/resolve/stub-resolv.conf managed by man:systemd-resolved(8).
    	   2   â”‚ # Do not edit.
    	   3   â”‚ #
    	   4   â”‚ # This file might be symlinked as /etc/resolv.conf. If you're looking at
    	   5   â”‚ # /etc/resolv.conf and seeing this text, you have followed the symlink.
    	   6   â”‚ #
    	   7   â”‚ # This is a dynamic resolv.conf file for connecting local clients to the
    	   8   â”‚ # internal DNS stub resolver of systemd-resolved. This file lists all
    	   9   â”‚ # configured search domains.
    	  10   â”‚ #
    	  11   â”‚ # Run "resolvectl status" to see details about the uplink DNS servers
    	  12   â”‚ # currently in use.
    	  13   â”‚ #
    	  14   â”‚ # Third party programs should typically not access this file directly, but only
    	  15   â”‚ # through the symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a
    	  16   â”‚ # different way, replace this symlink by a static file or a different symlink.
    	  17   â”‚ #
    	  18   â”‚ # See man:systemd-resolved.service(8) for details about the supported modes of
    	  19   â”‚ # operation for /etc/resolv.conf.
    	  20   â”‚
    	  21   â”‚ nameserver 127.0.0.53
    	  22   â”‚ options edns0 trust-ad
    	  23   â”‚ search ap-northeast-2.compute.internal
    	â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€(ğŸ |DOIK-Lab:default) root@k8s-m:~# resolvectl status
    	Global
    	       Protocols: -LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported
    	resolv.conf mode: stub
    	
    	Link 2 (ens5)
    	    Current Scopes: DNS
    	         Protocols: +DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported
    	Current DNS Server: 192.168.0.2
    	       DNS Servers: 192.168.0.2
    	        DNS Domain: ap-northeast-2.compute.internal
    	
    	Link 3 (docker0)
    	Current Scopes: none
    	     Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported
    	
    	Link 4 (tunl0)
    	Current Scopes: none
    	     Protocols: -DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# ip -c route**
    	default via 192.168.10.1 dev ens5 proto dhcp src 192.168.10.10 metric 100 
    	172.16.24.0/24 via 192.168.20.103 dev tunl0 proto bird onlink
    	blackhole 172.16.116.0/24 proto bird
    	172.16.158.0/24 via 192.168.10.101 dev ens5 proto bird
    	172.16.184.0/24 via 192.168.10.102 dev ens5 proto bird
    	172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown
    	192.168.0.2 via 192.168.10.1 dev ens5 proto dhcp src 192.168.10.10 metric 100
    	192.168.10.0/24 dev ens5 proto kernel scope link src 192.168.10.10 metric 100
    	192.168.10.1 dev ens5 proto dhcp scope link src 192.168.10.10 metric 100
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# iptables -t filter -S**
    //...ìƒëµ...
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# iptables -t nat -S**
    //...ìƒëµ...
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# systemctl list-unit-files | grep 'enabled'**
    //...ìƒëµ...
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# lsmod**
    //...ìƒëµ...
    ```
    
7. ëª¨ë‹ˆí„°ë§ *(ì˜µì…˜)*
    
    ```jsx
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# docker run --rm -it --name gtop --net='host' --pid="host" aksakalli/gtop
    ```
    
    ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%208.png)
    

### **ìŠ¤í…Œì´íŠ¸í’€ì…‹ & í—¤ë“œë¦¬ìŠ¤ì„œë¹„ìŠ¤** ì‹¤ìŠµ

1. pod ë°°í¬
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# curl -s -O https://raw.githubusercontent.com/kubernetes/website/main/content/en/examples/application/w                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚eb/web.yaml                                                                                                                                                                              â”‚CPU1   9.0%  â”‚ â”‚
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# cat web.yaml                                                                                                                                        â”‚CPU2  10.0%  â”‚ â”‚**
    	â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚ File: web.yaml                                                                                                                    â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â£€â ¤â ¤â ’â     â ˆ      â”‚
    	â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’â ’    â”‚   1   â”‚ apiVersion: v1                                                                                                                                                                                  â”‚
    	   2   â”‚ kind: Service                                                                                                                                                                                   â”‚
    	   3   â”‚ metadata:                                                                                                                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    	   4   â”‚   name: nginx                                                                                                                     oryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 
    	   5   â”‚   labels:                                                                                                                                                 â¢¸â£¿â 33%â¢¹â£¿                             â”‚ 
    	   6   â”‚     app: nginx                                                                                                                                            â ˜â¢¿â£§â£„â£€â£¤â£¿â Ÿ                             â”‚ 
    	   7   â”‚ spec:                                                                                                                                                                                          â”‚ 
    	   8   â”‚   ports:                                                                                                                          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 
    	   9   â”‚   - port: 80                                                                                                                      pâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 
    	  10   â”‚     name: web                                                                                                                                             â¢¸â£¿â  0%â¢¹â£¿                             â”‚ 
    	  11   â”‚   clusterIP: None                                                                                                                                         â ˜â¢¿â£§â£„â£€â£¤â£¿â Ÿ                             â”‚ 
    	  12   â”‚   selector:                                                                                                                                                                                    â”‚ 
    	  13   â”‚     app: nginx                                                                                                                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 
    	  14   â”‚ ---
    	  15   â”‚ apiVersion: apps/v1                                                                                                               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    	  16   â”‚ kind: StatefulSet                                                                                                                  %MEM                                                         â”‚
    	  17   â”‚ metadata:                                                                                                                                                                                       â”‚
    	  18   â”‚   name: web                                                                                                                         0.3                                                         â”‚
    	  19   â”‚ spec:                                                                                                                               0.0                                                         â”‚
    	  20   â”‚   serviceName: "nginx"                                                                                                              0.0                                                         â”‚
    	  21   â”‚   replicas: 2
    	  22   â”‚   selector:
    	  23   â”‚     matchLabels:
    	  24   â”‚       app: nginx
    	  25   â”‚   template:
    	  26   â”‚     metadata:
    	  27   â”‚       labels:
    	  28   â”‚         app: nginx
    	  29   â”‚     spec:
    	  30   â”‚       containers:
    	  31   â”‚       - name: nginx
    	  32   â”‚         image: k8s.gcr.io/nginx-slim:0.8
    	  33   â”‚         ports:
    	  34   â”‚         - containerPort: 80
    	  35   â”‚           name: web
    	  36   â”‚         volumeMounts:
    	  37   â”‚         - name: www
    	  38   â”‚           mountPath: /usr/share/nginx/html
    	  39   â”‚   volumeClaimTemplates:
    	  40   â”‚   - metadata:
    	  41   â”‚       name: www
    	  42   â”‚     spec:
    	  43   â”‚       accessModes: [ "ReadWriteOnce" ]
    	  44   â”‚       resources:
    	  45   â”‚         requests:
    	  46   â”‚           storage: 1Gi
    	  47   â”‚
    	â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl apply -f web.yaml && kubectl get pods -w -l app=nginx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl apply -f web.yaml && kubectl get pods -w -l app=nginx**
    	service/nginx created
    	statefulset.apps/web created
    	NAME    READY   STATUS    RESTARTS   AGE
    	web-0   0/1     Pending   0          0s
    	web-0   0/1     Pending   0          9s
    	web-0   0/1     ContainerCreating   0          9s
    	web-0   0/1     ContainerCreating   0          9s
    	web-0   1/1     Running             0          18s
    	web-1   0/1     Pending             0          0s
    	web-1   0/1     Pending             0          10s
    	web-1   0/1     ContainerCreating   0          10s
    	web-1   0/1     ContainerCreating   0          11s
    	web-1   1/1     Running             0          20s
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# for i in 0 1; do kubectl exec "web-$i" -- sh -c 'hostname'; done**
    	web-0
    	web-1
    ```
    
    - ë‹¤ë¥¸ í„°ë¯¸ë„ë¡œ ëª¨ë‹ˆí„°ë§
        
        ![Untitled](0%E1%84%8E%E1%85%A1%E1%84%89%E1%85%B5_%E1%84%87%E1%85%A1%E1%84%82%E1%85%B5%E1%86%AF%E1%84%85%E1%85%A1%20%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3%20%E1%84%89%E1%85%B5%E1%86%AF%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%92%E1%85%AA%E1%86%AB%E1%84%80%E1%85%A7%E1%86%BC%20%E1%84%87%E1%85%A2%E1%84%91%E1%85%A9_%E1%84%8C%E1%85%A1%E1%86%A8%E1%84%89%E1%85%A5%E1%86%BC%200d50674fa9034113b85ff8b448abaf0f/Untitled%209.png)
        
2. netshoot ì´ë¯¸ì§€ë¡œ netdebug íŒŒë“œì— zsh ì‹¤í–‰
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl run -it --rm netdebug --image=nicolaka/netshoot --restart=Never -- zsh**
    
    	If you don't see a command prompt, try pressing enter.
    	
    	                    dP            dP                           dP
    	                    88            88                           88
    	88d888b. .d8888b. d8888P .d8888b. 88d888b. .d8888b. .d8888b. d8888P
    	88'  `88 88ooood8   88   Y8ooooo. 88'  `88 88'  `88 88'  `88   88
    	88    88 88.  ...   88         88 88    88 88.  .88 88.  .88   88
    	dP    dP `88888P'   dP   `88888P' dP    dP `88888P' `88888P'   dP
    	
    	Welcome to Netshoot! (github.com/nicolaka/netshoot)
    	
    	
    	
    	 **netdebug î‚° ~ î‚°
    	
    	 netdebug î‚° ~ î‚° nslookup nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		Name:   nginx.default.svc.cluster.local
    		Address: 172.16.24.2
    		Name:   nginx.default.svc.cluster.local
    		Address: 172.16.158.2
    	
    	
    	 **netdebug î‚° ~ î‚° nslookup -type=srv nginx**     
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		nginx.default.svc.cluster.local service = 0 50 80 web-0.nginx.default.svc.cluster.local.
    		nginx.default.svc.cluster.local service = 0 50 80 web-1.nginx.default.svc.cluster.local.
    		
    	
    	 **netdebug î‚° ~ î‚° nslookup web-0.nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		Name:   web-0.nginx.default.svc.cluster.local
    		Address: 172.16.158.2
    	
    	
    	 **netdebug î‚° ~ î‚° nslookup web-1.nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		Name:   web-1.nginx.default.svc.cluster.local
    		Address: 172.16.24.2
    		
    	
    	 **netdebug î‚° ~ î‚° exit**
    		pod "netdebug" deleted
    ```
    
3. íŒŒë“œ ì‚­ì œ ì‹¤í–‰ í›„ ì¬ì‹¤í–‰ ì‹œ ìƒì„± ìˆœì„œ í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl delete pod -l app=nginx && kubectl get pods -w -l app=nginx**
    		pod "web-0" deleted
    		pod "web-1" deleted
    		NAME    READY   STATUS              RESTARTS   AGE
    		web-0   0/1     ContainerCreating   0          1s
    		web-0   1/1     Running             0          2s
    		web-1   0/1     Pending             0          0s
    		web-1   0/1     Pending             0          0s
    		web-1   0/1     ContainerCreating   0          0s
    		web-1   0/1     ContainerCreating   0          1s
    		web-1   1/1     Running             0          2s
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# for i in 0 1; do kubectl exec web-$i -- sh -c 'hostname'; done**
    	web-0
    	web-1
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl run -it --rm netdebug --image=nicolaka/netshoot --restart=Never -- zsh**
    	If you don't see a command prompt, try pressing enter.
    	                    dP            dP                           dP   
    	                    88            88                           88
    	88d888b. .d8888b. d8888P .d8888b. 88d888b. .d8888b. .d8888b. d8888P
    	88'  `88 88ooood8   88   Y8ooooo. 88'  `88 88'  `88 88'  `88   88
    	88    88 88.  ...   88         88 88    88 88.  .88 88.  .88   88
    	dP    dP `88888P'   dP   `88888P' dP    dP `88888P' `88888P'   dP
    	
    	Welcome to Netshoot! (github.com/nicolaka/netshoot)
    	
    	
    	
    	 **netdebug î‚° ~ î‚° nslookup nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    	
    		Name:   nginx.default.svc.cluster.local
    		Address: 172.16.24.4
    		Name:   nginx.default.svc.cluster.local
    		Address: 172.16.158.3
    	
    	
    	 **netdebug î‚° ~ î‚° nslookup -type=srv nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		nginx.default.svc.cluster.local service = 0 50 80 web-0.nginx.default.svc.cluster.local.
    		nginx.default.svc.cluster.local service = 0 50 80 web-1.nginx.default.svc.cluster.local.
    		
    	
    	 **netdebug î‚° ~ î‚° nslookup web-0.nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    		
    		Name:   web-0.nginx.default.svc.cluster.local
    		Address: 172.16.158.3
    	
    	
    	 **netdebug î‚° ~ î‚° nslookup web-1.nginx**
    		Server:         10.200.1.10
    		Address:        10.200.1.10#53
    	
    	**Name:   web-1.nginx.default.svc.cluster.local**
    		Address: 172.16.24.4
    	
    	
    	 **netdebug î‚° ~ î‚° exit**
    		pod "netdebug" deleted
    ```
    
4. pvc í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl get pvc -l app=nginx**
    	NAME        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
    	www-web-0   Bound    pvc-7cce446e-e68a-4783-99f9-fbb891538669   1Gi        RWO            local-path     11m
    	www-web-1   Bound    pvc-7defb95e-8b02-4886-851b-e339e234fd71   1Gi        RWO            local-path     11m
    ```
    
5. ì›¹ ì„œë²„ index.html ì— hostname ì¶”ê°€ í›„ ì›¹ ì ‘ì† í•´ì„œ í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# for i in 0 1; do kubectl exec "web-$i" -- sh -c 'echo "$(hostname)-pv-test" > /usr/share/nginx/html/index.html'; done
    (ğŸ |DOIK-Lab:default) root@k8s-m:~# for i in 0 1; do kubectl exec -i -t "web-$i" -- curl http://localhost/; done**
    	web-0-pv-test
    	web-1-pv-test
    ```
    
6. íŒŒë“œ ì‚­ì œ ì‹¤í–‰ í›„ ì¬ì‹¤í–‰ ì‹œ ìƒì„± ìˆœì„œ í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl delete pod -l app=nginx && kubectl get pods -w -l app=nginx**
    	pod "web-0" deleted
    	pod "web-1" deleted
    	NAME    READY   STATUS              RESTARTS   AGE
    	web-0   0/1     ContainerCreating   0          0s
    	web-0   0/1     ContainerCreating   0          1s
    	web-0   1/1     Running             0          2s
    	web-1   0/1     Pending             0          0s
    	web-1   0/1     Pending             0          0s
    	web-1   0/1     ContainerCreating   0          0s
    	web-1   0/1     ContainerCreating   0          1s
    	web-1   1/1     Running             0          2s
    ```
    
7. ì›¹ ì ‘ì† í•´ì„œ í™•ì¸ : PV ì €ì¥ì†Œ í™•ì¸
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# for i in 0 1; do kubectl exec -i -t "web-$i" -- curl http://localhost/; done**
    	web-0-pv-test
    	web-1-pv-test
    ```
    
8. pod scale out & scale in
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl scale sts web --replicas=5 && kubectl get pods -w -l app=nginx**
    	statefulset.apps/web scaled
    	NAME    READY   STATUS    RESTARTS   AGE
    	web-0   1/1     Running   0          88s
    	web-1   1/1     Running   0          86s
    	web-2   0/1     Pending   0          0s
    	web-2   0/1     Pending   0          10s
    	web-2   0/1     ContainerCreating   0          10s
    	web-2   0/1     ContainerCreating   0          11s
    	web-2   1/1     Running             0          18s
    //...ìƒëµ...
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl patch sts web -p '{"spec":{"replicas":3}}' && kubectl get pods -w -l app=nginx**
    	statefulset.apps/web patched
    	NAME    READY   STATUS        RESTARTS   AGE
    	web-0   1/1     Running       0          2m54s
    	web-1   1/1     Running       0          2m52s
    	web-2   1/1     Running       0          86s
    	web-3   1/1     Running       0          68s
    	web-4   1/1     Terminating   0          61s
    	web-4   1/1     Terminating   0          62s
    	web-4   0/1     Terminating   0          62s
    	web-4   0/1     Terminating   0          62s
    	web-4   0/1     Terminating   0          62s
    //...ìƒëµ...
    ```
    
9. ë¦¬ì†ŒìŠ¤ ì‚­ì œ
    
    ```jsx
    **(ğŸ |DOIK-Lab:default) root@k8s-m:~# kubectl delete -f web.yaml && kubectl delete pvc --all**
    	service "nginx" deleted
    	statefulset.apps "web" deleted
    	persistentvolumeclaim "www-web-0" deleted
    	persistentvolumeclaim "www-web-1" deleted
    	persistentvolumeclaim "www-web-2" deleted
    	persistentvolumeclaim "www-web-3" deleted
    	persistentvolumeclaim "www-web-4" deleted
    ```